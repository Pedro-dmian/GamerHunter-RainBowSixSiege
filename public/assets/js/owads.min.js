var OwAd=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(3),a=r(n(1));t.StatsMap={lib:{loaded:"lib_loaded",error:"lib_error",goog_err:"goog_err"},ad:{iframe_loaded:"iframe_loaded",video_loaded:"ad_loaded.video",display_loaded:"ad_loaded.display",impression:{vid:"impression.video",disp:"impression.display"},video_complete:"complete"},targeting:{ow_no_resp:"targeting_no_response"},waterfall:{stuck:"waterfall_stuck",attempt:{success:{vid:"waterfall_sucess.video",disp:"waterfall_sucess.display"},failure:"waterfall_failure"}}},function(e){e.first_load="owads_first_load",e.refreshed="owads_refreshed",e.video_loaded="owads_video_loaded",e.vid_error="owads_vid_error",e.removed_before="owads_removed_before",e.impression_vid="owads_impression_vid",e.impression_disp="owads_impression_disp"}(t.DebugStats||(t.DebugStats={}));t.default=new class{constructor(){this._logger=new i.Logger(!1),this._sdkVer="",this._debugTracking=!1,this._profileInfo={},this._shortClientVersion=overwolf.version,this._extensionId=null,this._debugTrackingExtra={}}async initialize(e,t,n){this._logger=e,this._sdkVer=t,this._debugTracking=n,this._debugTrackingExtra.sdk_ver=t,this._debugTrackingExtra.ad_uid=e.uid||void 0,this.setShortClientVersion();try{const e=await a.default.getCurrentExtension();e&&(this._extensionId=e.manifest.UID,this._debugTrackingExtra.app_id=e.manifest.UID,this._debugTrackingExtra.app_ver=e.manifest.meta.version),this._profileInfo=await a.default.getProfileInfo()}catch(e){console.error(e)}}send(e){try{let t="owads."+this._sdkVer.replace(/\./g,"_");this._extensionId&&(t+="."+this._extensionId),t+="."+e;const n=new XMLHttpRequest;n.open("POST","https://tracking.overwolf.com/tracking/InsertStats?Stats=true"),n.setRequestHeader("Content-Type","application/json;charset=UTF-8");const r={Kind:40201,Extra:t};n.send(JSON.stringify(r)),this._logger.info("Sent stat: "+JSON.stringify(r))}catch(e){this._logger.info("Error tracking")}}debug(e,t){if(this._debugTracking)try{const n=new URLSearchParams;n.append("CurrentVersion",this._shortClientVersion),n.append("PartnerID",this._profileInfo.partnerId?this._profileInfo.partnerId.toString():"0"),n.append("Name",e),n.append("Value","0"),n.append("UserName",this._profileInfo.username||this._profileInfo.userId||""),t||(t={}),t=Object.assign(t,this._debugTrackingExtra),n.append("Extra",encodeURIComponent(`[${JSON.stringify(t)}]`)),n.append("owver",overwolf.version),n.append("MUID",this._profileInfo.machineId||"");const r=`http://analyticsnew.overwolf.com/analytics/Counter?${n.toString()}`,i=new XMLHttpRequest;i.open("GET",r),i.send()}catch(e){console.error(e)}}setShortClientVersion(){try{this._shortClientVersion=overwolf.version.substr(0,overwolf.version.lastIndexOf("."))}catch(e){}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),i=n(11);t.default=new class{constructor(){this._profileInfoPromise=null,this._currentExtensionPromise=null}async getProfileInfo(){const e=await this._profileInfoPromise;return e||(this._profileInfoPromise=r.OWProfileLite.getCurrentUser(),await this._profileInfoPromise)}async getCurrentExtension(){const e=await this._currentExtensionPromise;return e||(this._currentExtensionPromise=i.OWExtensionLite.current(),await this._currentExtensionPromise)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Timer=class{constructor(e,t,n){this._timerId=null,this._intervalInMS=0,this.onTimer=()=>{this._timerId=null,this._delegate.onTimer(this._id)},this._delegate=e,this._intervalInMS=t,this._id=n}static async wait(e){return new Promise(t=>{setTimeout(t,e)})}start(){this.stop(),this._timerId=setTimeout(this.onTimer,this._intervalInMS)}stop(){null!=this._timerId&&(clearTimeout(this._timerId),this._timerId=null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);t.Logger=class{constructor(e){this._enabled=!1,this._uid=r.UniqueId.generateWithDate(),this._enabled=e}get uid(){return this._uid}info(e,...t){if(!this._enabled)return;const n=this.format(e,...t);console.log.apply(console,n)}error(e,...t){if(!this._enabled)return;const n=this.format(e,...t);console.error.apply(console,n)}format(e,...t){const n=[];n.push("OWADS | UID:"+this._uid+" | ");for(var r=0;r<Object.keys(arguments).length;r++)n.push(arguments[Object.keys(arguments)[r]]);return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static generateWithDate(){return(new Date).getTime()+"_"+r.generate()}static generate(){return Math.floor(1e9*Math.random())}}t.UniqueId=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OWGamesLite=class{static getRunningGameInfo(){return new Promise(e=>{overwolf.games.getRunningGameInfo(e)})}static async getRecentlyPlayedGames(e=3){return new Promise(t=>{if(!overwolf.games.getRecentlyPlayedGames)return t(null);overwolf.games.getRecentlyPlayedGames(e,e=>{t(e.games)})})}static async getGameDBInfo(e){return new Promise(t=>{if(!overwolf.games.getGameDBInfo)return t(null);overwolf.games.getGameDBInfo(e,t)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OWWindowLite=class{static async getCurrentInfo(){return new Promise(async e=>{overwolf.windows.getCurrentWindow(t=>{e(t.window)})})}static async setMute(e=!0){return new Promise(async(t,n)=>{if(!overwolf.windows.setMute)return n("setMute doesn't exist");overwolf.windows.setMute(e,e=>{"success"!=e.status?n(e.reason):t()})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);e.exports=r.OwAd},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(9),s=n(12),o=n(13),l=n(3),d=r(n(0)),g=i(n(22)),u=i(n(23)),h=i(n(25));t.OwAd=class{constructor(e,t){this._options=s.OwAdOptionsDefaults.applyDefaultOptions(t),this._logger=new l.Logger(this._options.debug||!1),this._adManager=new o.AdManager(this._options,this._logger,e),this._exceptionsTracker=new a.ExceptionsTracker(this,this._options.maxBadExceptions,this._logger),this.init()}get uid(){return this._logger.uid}get version(){return h.default}get containerElem(){return{id:this._adManager.adContainerId}}play(){return this._adManager.play()}pause(){return this._adManager.pause()}refreshAd(e){return this.checkThrowAdManagerNotReadyException(this.refreshAd.name),e&&e.targeting&&(this._options.targeting=e.targeting),this._exceptionsTracker.reset(),this._adManager.refreshAd(e),!0}refreshCurrentWFstep(){this.checkThrowAdManagerNotReadyException(this.refreshCurrentWFstep.name),this._adManager.refreshCurrentWFstep()}removeAd(){return this._logger.info("removeAd called"),this._adManager.removeAd()}addEventListener(e,t){return this._adManager.addEventListener(e,t)}removeEventListener(e,t){return this._adManager.removeEventListener(e,t)}onReachedMaxExceptions(){this.removeAd()}async init(){this._logger.info("Overwolf Ad lib:",this.version),await d.default.initialize(this._logger,this.version,this._options.debugTracking||!1),g.default.run(this._logger),u.default.run(this.version),this._adManager.start(),d.default.send(d.StatsMap.lib.loaded),d.default.debug(d.DebugStats.first_load)}checkThrowAdManagerNotReadyException(e){if(!this._adManager.ready)throw`${e} called before the ad lib finished initializing!`}}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(0));class a{constructor(e,t=a.kMaxExceptions,n){this._badExceptionMessagesExpressions=[/.*cannot read property '(left|right)' of.*/i],this._countedBadExceptions=0,this.handleUncaughtException=(e,t,n)=>{this._badExceptionMessagesExpressions.some(t=>!!t.test(e)&&(this._countedBadExceptions++,!0)),this._countedBadExceptions>=this._maxExceptions&&this._delegate.onReachedMaxExceptions()},this.handleGlobalError=e=>{const{message:t,filename:n,lineno:r,colno:a,error:s}=e;if(n&&(-1!=n.indexOf("owads.min.js")||-1!=n.indexOf("owads.js"))){if(t){var o=n?"\nurl: "+n:"";o+=r?"\nline: "+r:"",o+=a?"\ncolumn: "+a:"";var l=t+(o+=s?"\nerror: "+s:"");this._logger.info("Caught OwAds err: ",l)}i.default.send(i.StatsMap.lib.error)}},this._delegate=e,this._maxExceptions=t,this._logger=n,overwolf.extensions.onUncaughtException.removeListener(this.handleUncaughtException),overwolf.extensions.onUncaughtException.addListener(this.handleUncaughtException),window.removeEventListener("error",this.handleGlobalError),window.addEventListener("error",this.handleGlobalError)}reset(){this._countedBadExceptions=0}}t.ExceptionsTracker=a,a.kMaxExceptions=500},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OWProfileLite=class{static async getCurrentUser(){return new Promise(e=>{overwolf.profile.getCurrentUser(e)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this._manifest=e}static async current(){return new Promise(e=>{overwolf.extensions.current.getManifest(t=>e(new r(t)))})}get manifest(){return this._manifest}}t.OWExtensionLite=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static applyDefaultOptions(e){e=e||{},"true"==localStorage.owAdLibDebug&&(e.debug=!0);return e=r.deepConditionalMerge({autoplay:!0,size:{width:400,height:300},trackWaterfallStuck:!0,debugTracking:!1},e)}static deepConditionalMerge(e,t){for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]&&t.hasOwnProperty(n)?t[n]=r.deepConditionalMerge(e[n],t[n]):t.hasOwnProperty(n)||(t[n]=JSON.parse(JSON.stringify(e[n]))));return t}}t.OwAdOptionsDefaults=r},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(14),a=n(15),s=n(16),o=n(18),l=n(19),d=n(20),g=n(21),u=r(n(0));class h extends o.EventDispatcher{constructor(e,t,n){super(),this._logger=t,this._logger.info("Container:",n),this._adContainerElement=new i.AdElementWrapper(n),this._adSlotSize=new l.AdSlotSizeFormatter(e.size||[]),this._googleTag=new a.GoogleTagLib(t,this._adSlotSize,this._adContainerElement,this),this._adIFrameCommunication=new g.AdIFrameCommunication(t,this),this._targetingInfo=new s.TargetingInfo(e,t),this._waterfallTracker=new d.WaterfallTracker(e,h.kDefaultAdUnit)}get adContainerId(){return this._adContainerElement.id}get ready(){return this._googleTag&&this._googleTag.apiReady}async start(){if(!this._googleTag.apiReady){if(!await this._googleTag.initialize())return!1}return await this._targetingInfo.initialize(),this.displayAd(),!0}play(){return this._adIFrameCommunication.play(),!0}pause(){return this._adIFrameCommunication.pause(),!0}refreshCurrentWFstep(){this.displayAd()}refreshAd(e){this.internalRemoveAd(),this._logger.info("RefreshAd"),u.default.debug(u.DebugStats.refreshed),this.displayAd()}removeAd(){return this._adIFrameCommunication.adType===g.AdTypes.Unkn&&u.default.debug(u.DebugStats.removed_before),this.internalRemoveAd()}internalRemoveAd(){return this._waterfallTracker.reset(),this._adIFrameCommunication.reset(),this._googleTag.cleanup(),this._adContainerElement.remove(),!0}async displayAd(){this._googleTag.defineSlot(this._waterfallTracker.adUnitName),await this._targetingInfo.refreshTargetingMap(),this._googleTag.display(this._targetingInfo.targetingMap)}nextWaterfallAttempt(){if(!this._waterfallTracker.nextAttempt()){const e=this._waterfallTracker.attempt;return u.default.send(`${u.StatsMap.waterfall.attempt.failure}.${e}`),!1}return this.displayAd(),!0}onInternalRendered(e){this._logger.info("Slot rendered. WF",this._waterfallTracker.attempt,"info:",e),super.fireEvent(h.kEvents.InternalRendered,e),e&&!e.isEmpty||this.nextWaterfallAttempt()||super.fireEvent(h.kEvents.Error,h.kErrors.NoAd)}onLoadLibraryError(){u.default.send(`${u.StatsMap.lib.goog_err}`),super.fireEvent(h.kEvents.Error,h.kErrors.LoadLib)}onGetTargetingInfo(){return this._targetingInfo.targetingMap}onAdError(e){u.default.debug(u.DebugStats.vid_error),this._waterfallTracker.cancelVidStuckCheck(),this.nextWaterfallAttempt()||this.onUnhandledEvent(e)}onPlayerLoaded(e){const t=this._adSlotSize.toString(!0);u.default.send(`${u.StatsMap.ad.video_loaded}.${t}`),u.default.debug(u.DebugStats.video_loaded,{slot_size:t}),this._waterfallTracker.startVidStuckCheck(),this.onUnhandledEvent(e)}onPlay(e){u.default.send(e.data.type),this.onUnhandledEvent(e)}onImpression(e){this._waterfallTracker.cancelVidStuckCheck();const t=this._waterfallTracker.attempt,n=this._adSlotSize.toString(!0);u.default.send(`${u.StatsMap.waterfall.attempt.success.vid}.${t}`),u.default.send(`${u.StatsMap.ad.impression.vid}.${n}`),u.default.debug(u.DebugStats.impression_vid,{slot_size:n}),this.onUnhandledEvent(e)}onComplete(e){const t=this._adSlotSize.toString(!0);u.default.send(`${u.StatsMap.ad.video_complete}.${t}`),this.onUnhandledEvent(e)}onUnhandledEvent(e){super.fireEvent(e.data.type,e.data)}onIFrameLoaded(e){const t=this._adSlotSize.toString(!0);u.default.send(`${u.StatsMap.ad.iframe_loaded}.${t}`),super.fireEvent("loaded",null)}onDisplayAdDetected(){super.fireEvent("display_ad_loaded",null);const e=this._waterfallTracker.attempt,t=this._adSlotSize.toString(!0),n=u.StatsMap.waterfall.attempt.success.disp;u.default.send(`${n}.${e}`),u.default.send(`${u.StatsMap.ad.impression.disp}.${t}`),u.default.debug(u.DebugStats.impression_disp,{slot_size:t})}}t.AdManager=h,h.kDefaultAdUnit=localStorage.owAdsForceAdUnit||"apps_400x300",h.kEvents={InternalRendered:"ow_internal_rendered",Error:"error"},h.kErrors={NoAd:"no ad",LoadLib:"load lib"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);t.AdElementWrapper=class{constructor(e){this._id=`ow_ad_container_${r.UniqueId.generate()}`,this._containerElement=e,this._adElement=this.create()}get id(){return this._id}get element(){return this._adElement}assureCreated(){this._adElement=this.create()}remove(){let e=this._adElement.parentElement;return!!e&&(e.querySelectorAll("iframe").forEach(function(e){e.remove()}),this._adElement.remove(),e.innerHTML="",!0)}create(){this.assureContainerElement();let e=this.getAdElement();if(e)return e;if((e=document.createElement("div")).id=this._id,this._containerElement.appendChild(e),!this.getAdElement())throw"Ad element not found";return e}assureContainerElement(){if(!this._containerElement)throw"Bad or no container element specified for ow ads";let e=this._containerElement.id;if(!e||0===e.length)return;let t=document.getElementById(e);t&&(this._containerElement=t)}getAdElement(){let e=document.getElementById(this._id);return e||null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);class i{constructor(e,t,n,a){this._googleTag=null,this._currentAdSlot=null,this._firstInitComplete=!1,this.libraryLoaded=()=>{this._loadLibraryTimeout.stop(),this._logger.info("DFP GOOGLETAG ready"),this._onReadyResolver(this._googleTag.apiReady)},this.onSlotRendered=e=>{this.tryToExtractSlotAdlibUid(e.slot)==this._logger.uid?this._delegate.onInternalRendered(e):this._logger.info("Ignoring slot rendered event for other ad's slot")},this._logger=e,this._adSlotSize=t.toString(),this._adContainer=n,this._onReadyResolver=()=>{},this._delegate=a,this._loadLibraryTimeout=new r.Timer(this,i.kLoadLibraryTimeoutDelay)}get apiReady(){return this._googleTag&&this._googleTag.apiReady}async initialize(){return new Promise(e=>{if(this._googleTag=window.googletag,this._googleTag&&this._googleTag.apiReady)return e();this._onReadyResolver=e,this.loadLibrary()})}cleanup(){document.querySelectorAll("script[src*='securepubads.g.doubleclick.net']").forEach(function(e){e.remove()})}defineSlot(e){this.destroyCurrentSlot(),this._adContainer.assureCreated();let t=this._adContainer.element.id;if(this._currentAdSlot=this._googleTag.defineSlot("/112006172/"+e,this._adSlotSize,t),null==this._currentAdSlot)throw"Error: Unable to create ad slot. This is often caused by creating a new OwAd with an element that is already used for another ad";this._currentAdSlot.addService(this._googleTag.pubads()),this._currentAdSlot.adElemenId=t}display(e){return!(!this._googleTag||!this._currentAdSlot)&&(this.setTargetingMap(e),this._googleTag.enableServices(),this._firstInitComplete?(this._logger.info("Refreshing"),this._googleTag.pubads().clear([this._currentAdSlot]),this._googleTag.pubads().refresh([this._currentAdSlot])):(this._logger.info("First init complete"),this._googleTag.pubads().addEventListener("slotRenderEnded",this.onSlotRendered),this._googleTag.display(this._currentAdSlot.adElemenId),this._firstInitComplete=!0),!0)}setTargeting(e,t){return!!this._currentAdSlot&&(this._currentAdSlot.setTargeting(e,t),!0)}clearTargeting(e,t){return!!this._currentAdSlot&&(this._currentAdSlot.clearTargeting(e),!0)}setTargetingMap(e){for(let t in e){let n=e[t];this.setTargeting(t,n)}}loadLibrary(){this._googleTag=window.googletag=window.googletag||{},this._googleTag.cmd=this._googleTag.cmd||[];const e=this;!function(){let t=document.createElement("script");t.async=!0,t.type="text/javascript",t.src="http://www.googletagservices.com/tag/js/gpt.js";let n=document.getElementsByTagName("script")[0];if(!n||!n.parentNode)return e._logger.error("couldn't load google tag"),e._onReadyResolver(!1);n.parentNode.insertBefore(t,n)}(),this._googleTag.cmd.push(this.libraryLoaded),this._loadLibraryTimeout.start()}destroyCurrentSlot(){var e;if(null==this._currentAdSlot)return;this._googleTag.destroySlots([this._currentAdSlot]),delete this._currentAdSlot;const t=null===(e=this._adContainer)||void 0===e?void 0:e.element;null!=t&&(t.innerHTML="")}tryToExtractSlotAdlibUid(e){let t=e.getTargeting("ow_ad_lib_uid");return t&&t.length>0?t[0]:(console.error("Unable to extract owad UID."),null)}onTimer(e){this._delegate.onLoadLibraryError()}}t.GoogleTagLib=i,i.kLoadLibraryTimeoutDelay=2e4},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(17),a=n(2),s=r(n(0));class o{constructor(e,t){this._targetingMap={},this._options=e,this._logger=t,this._fetchers=new i.TargetingInfoFetchers(e,t),this._targetingTimeout=new a.Timer(this,o.kWaitOwAPIDelay)}get targetingMap(){return this._targetingMap}async initialize(){this._targetingTimeout.start(),await this._fetchers.initialize(),this._targetingTimeout.stop()}async refreshTargetingMap(){for(let e in this._options.targeting){let t=this._options.targeting[e];this._logger.info("Set from opt:",e,t),this.setTargeting(e,t)}this._logger.info("uid=",this._logger.uid),this.setTargeting("ow_ad_lib_uid",this._logger.uid),this.setTargeting("ow_ad_lib_autoplay",this._options.autoplay?"true":"false"),this._targetingTimeout.start(),this.setProfileTargetingInfo(),this.setMachineTargetingInfo(),this.setInstalledGamesInfo(),this.setManifestInfo(),await this.setRunningGameInfo(),this.setDebugTargetingInfo(),this._targetingTimeout.stop()}setTargeting(e,t){this._targetingMap[e]=t}clearTargeting(e){return!(!this._targetingMap.hasOwnProperty(e)||!this._targetingMap[e])&&(delete this._targetingMap[e],!0)}setProfileTargetingInfo(){let e=this._fetchers.profileInfo;if(e&&e.username)this.setTargeting("username",e.username),e.userId&&(this.setTargeting("user_id",e.userId),this._logger.info("user_id=",e.userId)),this.setTargeting("channel",e.channel),this.setTargeting("partner",e.partnerId),e.machineId&&(this.setTargeting("machine_id",e.machineId),this._logger.info("machine_id=",e.machineId));else{let e=localStorage.owAdsLastLoggedInUsername;e&&(this.setTargeting("username",e),this._logger.info("Set user from lclStrg"))}}setMachineTargetingInfo(){let e=this._fetchers.machineTargetingInfo;if(e)try{for(let t in e)this.setTargeting(t,e[t])}catch(e){}}setInstalledGamesInfo(){let e=this._fetchers.installedGames;e&&0!=e.length&&this.setTargeting("installed_games",e)}setManifestInfo(){let e=this._fetchers.manifestInfo;e&&(this.setTargeting("app_id",e.UID),this.setTargeting("app_version",e.meta.version))}async setRunningGameInfo(){let e=await this._fetchers.getRunningGameNameAndGenre();e&&this.setTargeting(e.genre,e.name)}setDebugTargetingInfo(){if(localStorage.OwAds_DebugTargeting)try{let e=JSON.parse(localStorage.OwAds_DebugTargeting);for(let t in e){let n=e[t];this._logger.info("Debug targeting: ",t,n),this.setTargeting(t,n)}}catch(e){}}onTimer(e){s.default.send(s.StatsMap.targeting.ow_no_resp)}}t.TargetingInfo=o,o.kWaitOwAPIDelay=1e4},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),a=r(n(1));class s{constructor(e,t){this._profileInfo=null,this._machineTargetingInfo=null,this._installedGames=[],this._manifestInfo=null,this._options=e,this._logger=t}get profileInfo(){return this._profileInfo}get machineTargetingInfo(){return this._machineTargetingInfo}get installedGames(){return this._installedGames}get manifestInfo(){return this._manifestInfo}async initialize(){await this.getProfileInfo(),await this.getInstalledGames(),await this.getManifestInfo()}async getRunningGameNameAndGenre(){let e=await i.OWGamesLite.getRunningGameInfo();if(e){let t=Math.floor(e.id/10),n=this.getGenre(t);return this._logger.info("Genre:",n),{genre:n,name:e.title}}if(localStorage.latestSession)try{var t=JSON.parse(localStorage.latestSession);if(t.game){let e=this.getGenre(parseInt(t.game.id));return this._logger.info("Game genre (GS)",e),{genre:e,name:t.game.name}}}catch(e){}else this._logger.info("No game running");return null}async getProfileInfo(){this._profileInfo=await a.default.getProfileInfo();let e=this._profileInfo.status,t=this._profileInfo.reason;"success"===e?localStorage.owAdsLastLoggedInUsername=this._profileInfo.username:"error"===e&&"Not signed in"===t?this._logger.info("Error getting username"):this._logger.info("Error getting profile",this._profileInfo),await this.getMachineCampaignTargeting()}async getMachineCampaignTargeting(){if(this._machineTargetingInfo=null,!this._profileInfo||!this._profileInfo.machineId)return;let e=this._profileInfo.machineId;this._logger.info("machineId",e);try{let t=`${s.kMachineCmpginTargetingUrl}${e}.json`,n=await fetch(t);if(200!=n.status)return;this._machineTargetingInfo=await n.json()}catch(e){this._logger.error(e)}}async getInstalledGames(){this._installedGames=[];for(let e in s.kIntrestingInstalledGameIds){let t=await i.OWGamesLite.getGameDBInfo(parseInt(e));if(t&&t.installedGameInfo){let t=s.kIntrestingInstalledGameIds[e];this._installedGames.push(t)}}this._logger.info("Installed:",this._installedGames)}async getManifestInfo(){this._manifestInfo=null;const e=await a.default.getCurrentExtension();this._manifestInfo=e.manifest,this._logger.info("AppInfo:",this._manifestInfo.UID,this._manifestInfo.meta.version)}getGenre(e){for(let t in s.kGenresDict){let n=s.kGenresDict[t];for(let r=0;r<n.length;++r)if(n[r]==e)return t}return"NA"}}t.TargetingInfoFetchers=s,s.kMachineCmpginTargetingUrl="http://content.overwolf.com/libs/ads/machine_targeting/",s.kIntrestingInstalledGameIds={8032:"minecraft",9898:"hearthstone",765:"wow",10624:"hots",10844:"overwatch",7764:"csgo",10798:"rocket_league"},s.kGenresDict={General:[2,585,601,603,619,689,947,1045,1065,1067,1089,1163,1166,1316,1598,1613,1616,1769,1835,1886,2066,2261,2273,2276,2279,2327,2339,2363,2459,2480,2489,2549,2660,2699,2705,2816,2852,2966,2999,3086,3110,3140,3167,3182,3194,3197,3212,3338,3527,3605,3608,3683,4013,4106,4157,4166,4178,4244,4271,4313,4337,4376,4496,4607,4721,4739,4784,4970,5069,5444,5462,5492,5498,5597,5786,5789,5855,5930,5960,6209,6225,6263,6339,6348,6349,6356,6364,6372,6426,6480,6520,6522,6546,6558,6606,6626,6694,6720,6722,6814,6858,6976,6998,7084,7208,7226,7256,7264,7270,7278,7308,7348,7390,7430,7672,8018,8032,8108,8212,8214,8218,8250,8258,8284,8304,8380,8438,8470,8512,8530,8584,8654,8672,8680,8694,8758,8790,8818,8822,9010,9066,9126,9158,9172,9176,9178,9200,9216,9220,9254,9312,9342,9344,9346,9348,9352,9354,9356,9358,9360,9362,9364,9366,9368,9370,9374,9376,9378,9380,9382,9386,9388,9390,9392,9394,9396,9404,9406,9408,9412,9414,9416,9418,9420,9422,9424,9434,9438,9466,9470,9480,9482,9527,9562,9565,9581,9595,9682,9756,9780,9856,9858,9868,9876,9898,10066,10080,10100,10104,10116,10122,10156,10160,10180,10216,10278,10332,10350,10410,10450,10454,10458,10462,10470,10540,10546,10612,10614,10628,10656,10670,10684,10696,10706,10708,10712,10724,10728,10732,10734,10744,10748,10754,10756,10764,10794,10806,10820,10822,10824,10828],FPS:[10844,4,487,589,607,611,661,667,695,705,809,811,935,937,959,997,1001,1015,1025,1027,1101,1139,1190,1361,1406,1580,1586,1670,1760,2258,2537,2540,2543,2573,2648,2984,2987,3026,3038,3146,3176,3179,3203,3248,3872,3965,4037,4307,4406,4409,4436,4492,4493,4494,4495,4571,4997,5114,5138,5150,5165,5171,5369,5414,5420,5501,5561,5564,5594,5849,5957,6035,6239,6243,6351,6367,6369,6370,6416,6650,6664,6708,6780,6918,7006,7100,7150,7204,7230,7306,7358,7360,7374,7454,7638,7708,7764,7784,7872,7926,8228,8322,8352,8448,8474,8488,8546,8602,8652,8668,9110,9198,9206,9208,9491,9497,9674,9698,9810,9864,9866,1e4,10286,10346,10504,10606,10616,10622,10680,10702,10703,10704,10710,10738,10740,10750,10758,10768,10776,10786,10800],RPG:[409,567,763,765,795,837,861,863,979,999,1023,1079,1136,1157,1265,1529,1751,1754,1829,1832,1892,1937,2207,2360,2369,2522,2525,2546,2684,2771,2801,2897,2906,2951,3158,3317,3341,3342,3356,3431,3539,3542,3698,3710,3728,3740,3809,3824,4145,4184,4214,4235,4331,4466,4487,4502,4535,4541,4559,4592,4685,4697,4922,4931,4985,5081,5123,5198,5225,5333,5351,5408,5417,5438,5450,5543,5615,5669,5753,5864,5993,6002,6011,6038,6107,6157,6159,6199,6217,6350,6355,6375,6442,6448,6462,6478,6486,6500,6568,6592,6594,6596,6600,6648,6766,6792,6828,6842,7e3,7010,7022,7152,7156,7192,7212,7216,7228,7234,7272,7342,7364,7412,7438,7460,7478,7510,7584,7590,7642,7646,7674,7680,7822,7856,7864,7970,7972,8004,8356,8620,8678,8824,8826,8828,8830,9092,9096,9180,9182,9448,9464,9488,9518,9530,9644,9714,9734,9800,10038,10110,10128,10182,10284,10288,10292,10342,10348,10404,10456,10510,10530,10608,10620,10626,10650,10652,10658,10660,10718,10720,10772,10784,10802,10836],Action_Adventure:[481,508,529,532,669,865,867,1031,1160,1322,1340,1343,1397,1460,1724,1874,2084,2243,2411,2450,2456,2468,2558,2594,2663,2711,3080,3215,3413,3566,3569,3755,3893,3989,4139,4142,4289,4301,4442,4529,4580,4646,4679,4688,4826,4835,4994,5360,5387,5390,5402,5411,5558,5750,5774,5981,6077,6165,6211,6231,6237,6265,6269,6343,6365,6383,6389,6428,6450,6452,6496,6578,6608,6644,6670,6738,6760,6854,6902,6932,6960,7104,7132,7138,7236,7276,7282,7346,7356,7380,7392,7394,7396,7428,7486,7494,7866,7934,7938,7958,7998,8118,8126,8128,8130,8132,8204,8242,8252,8344,8402,8408,8416,8452,8486,8498,8516,8528,8548,8582,8614,8636,8676,8746,8748,8756,8768,8776,8804,8954,9006,9024,9026,9028,9030,9032,9034,9084,9114,9130,9170,9190,9218,9232,9252,9272,9460,9462,9505,9515,9577,9584,9596,9597,9598,9600,9602,9670,9694,9696,9700,9794,9798,9802,9804,9806,9896,9920,9938,9970,9982,10002,10018,10050,10070,10102,10106,10108,10114,10140,10158,10204,10212,10224,10248,10260,10340,10344,10376,10380,10406,10408,10412,10414,10448,10452,10460,10468,10480,10502,10506,10508,10514,10516,10518,10520,10522,10526,10528,10532,10552,10590,10592,10594,10598,10600,10602,10604,10610,10618,10630,10632,10634,10636,10638,10642,10644,10646,10648,10654,10666,10668,10672,10676,10682,10686,10688,10692,10694,10714,10716,10722,10726,10730,10736,10742,10746,10752,10760,10762,10766,10770,10774,10778,10780,10782,10788,10798,10808,10810,10814,10818],MOBA:[5318,5426,7314,8134,8358,8820,9402,9594,9728,9872,10276,10296,10298,10338,10512,10624,10690,10804],MMORPG:[8946,9350,9372,9384,9398,9400,9410,9468,9472,9474,9476,9478,9486]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EventDispatcher=class{constructor(){this._eventListeners={}}addEventListener(e,t){return this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t),!0}removeEventListener(e,t){if(!this._eventListeners[e])return!1;const n=this._eventListeners[e].indexOf(t);return!(n<0||(this._eventListeners[e]=this._eventListeners[e].splice(n,1),0))}fireEvent(e,t){if(!this._eventListeners.hasOwnProperty(e))return null;this._eventListeners[e].forEach(e=>{try{e(t)}catch(e){}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AdSlotSizeFormatter=class{constructor(e){this._size=e}toString(e=!1){if(!this._size)return"";let t;if(Array.isArray(this._size)){t=[];for(var n=0;n<this._size.length;n++)t.push([this._size[n].width,this._size[n].height])}else t=[this._size.width,this._size.height];return e?2===t.length?t[0]+"x"+t[1]:"":t}}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),a=r(n(0));class s{constructor(e,t){this._currentAttempt=1,this._options=e,this._adUnitName=t,this._videoStuckTimer=new i.Timer(this,s.kVidWFStuckDelay)}get attempt(){return this._currentAttempt}get adUnitName(){return 1===this.attempt?this._adUnitName:`${this._adUnitName}_wf${this.attempt}`}reset(){this._currentAttempt=1,this._videoStuckTimer.stop()}nextAttempt(){return this._videoStuckTimer.stop(),!(this._currentAttempt+1>s.kMaxAttempts)&&(this._currentAttempt++,!0)}startVidStuckCheck(){this._options.trackWaterfallStuck&&this._videoStuckTimer.start()}cancelVidStuckCheck(){this._videoStuckTimer.stop()}onTimer(e){a.default.send(a.StatsMap.waterfall.stuck)}}t.WaterfallTracker=s,s.kMaxAttempts=6,s.kVidWFStuckDelay=3e5},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Loading=1]="Loading",e[e.DfpLoaded=2]="DfpLoaded",e[e.Ready=3]="Ready"}(r||(r={})),function(e){e[e.Unkn=0]="Unkn",e[e.Vid=1]="Vid",e[e.Disp=2]="Disp"}(i=t.AdTypes||(t.AdTypes={}));class a{constructor(e,t){this._adContainerIframe=null,this._pendingMessages=[],this._currentState=r.Loading,this._currentAdType=i.Unkn,this.handleMsgFromIFrame=e=>{if(e.data.sourceIsOwAdIframe&&e.data.ad_uid==this._logger.uid){if(e.data.isPlayerEvent)return this.handlePlayerEvent(e);switch(e.data.type){case"overwolf_ad_iframe_loaded":this.handleAdIframeLoaded(e)}}},this._logger=e,this._delegate=t,window.removeEventListener("message",this.handleMsgFromIFrame),window.addEventListener("message",this.handleMsgFromIFrame)}get adType(){return this._currentAdType}reset(){this._currentState=r.Loading,this._currentAdType=i.Unkn,this._pendingMessages=[],this._adContainerIframe=null}pause(){if(this._currentState!=r.Ready)throw a.kErrorPrematureCall;this.sendMessage("pause")}play(){if(this._currentState!=r.Ready)throw a.kErrorPrematureCall;this.sendMessage("play")}sendMessage(e){null!=this._adContainerIframe?("string"==typeof e&&(e={type:e}),e.isOwAdOrigin=!0,this._adContainerIframe.postMessage(e,"*")):this._pendingMessages.push(e)}handlePlayerEvent(e){if(e.data.action===a.kActionTargetInfoRequest){this._logger.info("IFRAME target info req");let e=this._delegate.onGetTargetingInfo();return this.sendMessage({action:"TargetInfoReply",targetMap:e})}return e.data.type===a.kTypeError?this._delegate.onAdError(e):(this._logger.info("Player event",e.data),e.data.type===a.kTypePlayerLoaded?(this._logger.info("Player is loaded/ready"),this._currentState=r.Ready,this._currentAdType=i.Vid,this._delegate.onPlayerLoaded(e)):(delete e.data.isPlayerEvent,delete e.data.sourceIsOwAdIframe,e.data.type===a.kTypePlay?this._delegate.onPlay(e):e.data.type===a.kTypeImpression?this._delegate.onImpression(e):e.data.type===a.kTypeComplete?this._delegate.onComplete(e):void this._delegate.onUnhandledEvent(e)))}handleAdIframeLoaded(e){this._currentState=r.DfpLoaded,this._delegate.onIFrameLoaded(e),this.setAdContainerIframe(e),this.detectDisplayAd(),this._pendingMessages.map(this.sendMessage)}setAdContainerIframe(e){const t=window.frames;for(let n=0;n<t.length;++n)if(t[n]===e.source)return void(this._adContainerIframe=t[n]);this._logger.error("Can't find ad IFRAME")}detectDisplayAd(){const e="Can't determine ad is display";if(this._adContainerIframe)try{let t=this._adContainerIframe.document.documentElement,n=t.querySelector("iframe");(t.querySelectorAll("#adImage").length>0||n&&-1!==n.src.indexOf("/display/"))&&(this._currentAdType=i.Disp,this._delegate.onDisplayAdDetected(),this._logger.info("Ad is a display ad"))}catch(t){this._logger.error(e)}else this._logger.error(e)}}t.AdIFrameCommunication=a,a.kActionTargetInfoRequest="TargetInfoRequest",a.kTypePlayerLoaded="player_loaded",a.kTypeError="error",a.kTypePlay="play",a.kTypeImpression="impression",a.kTypeComplete="complete",a.kErrorPrematureCall="owAds: pause() called prematurely. Video ad still not present. Please wait for player_loaded event before calling pause/play"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.default=new class{async run(e){try{await r.OWWindowLite.setMute(!0)}catch(t){e.error("Failed muting window")}}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(24),a=n(5),s=n(6),o=r(n(1));class l{async run(e){const t=new URLSearchParams;t.append(l.kParamSdkVer,e),t.append(l.kParamOwVer,overwolf.version),await this.appendRecentlyPlayedGames(t),await this.appendCurrentGame(t),await this.appendSystemInfo(t),await this.appendManifestInfo(t),await this.appendWindowInfo(t),await this.appendProfileInfo(t),this.loadHiddenIFrame(t)}async appendRecentlyPlayedGames(e){const t=l.kLastPlayedGamesLimit,n=await a.OWGamesLite.getRecentlyPlayedGames(t);if(!n)return;const r=[];for(let e=0;e<n.length;++e){const t=Math.floor(n[e]/10),i=await this.getGameName(t);i&&r.push(i)}e.append(l.kParamGames,encodeURI(r.join(",")))}async appendCurrentGame(e){const t=await a.OWGamesLite.getRunningGameInfo();if(!t)return;const n=Math.floor(t.id/10),r=await this.getGameName(n);r&&e.append(l.kParamCurrentGame,encodeURIComponent(r))}async appendSystemInfo(e){try{const t=await i.OWUtilsLite.getSystemInformation();e.append(l.kParamSysInfo,encodeURIComponent(JSON.stringify(t)))}catch(e){}}async appendManifestInfo(e){const t=(await o.default.getCurrentExtension()).manifest;e.append(l.kParamAppId,t.UID),e.append(l.kParamManifest,encodeURIComponent(JSON.stringify({appName:t.meta.name,appVer:t.meta.version})))}async appendWindowInfo(e){const t=await s.OWWindowLite.getCurrentInfo();e.append(l.kParamWindowInfo,encodeURIComponent(JSON.stringify({name:t.name})))}async appendProfileInfo(e){const t=await o.default.getProfileInfo();e.append(l.kParamProfileInfo,encodeURIComponent(JSON.stringify({machineId:t.machineId})))}loadHiddenIFrame(e){const t=`https://content.overwolf.com/ads/custom-info.html?${e.toString()}`,n=document.createElement("iframe");n.src=t,n.style.display="none",document.getElementsByTagName("body")[0].append(n)}async getGameName(e){e=Math.floor(e);const t=await a.OWGamesLite.getGameDBInfo(e);if(!t)return null;let n=t.gameInfo;if(t.installedGameInfo&&(n=t.installedGameInfo.GameInfo),!n)return null;const r=n.DisplayName||n.GameTitle;return r||null}}l.kParamSdkVer="sdkver",l.kParamOwVer="owver",l.kParamGames="games",l.kParamCurrentGame="curgame",l.kParamSysInfo="sys",l.kParamAppId="appid",l.kParamManifest="manifest",l.kParamWindowInfo="win",l.kParamProfileInfo="prof",l.kLastPlayedGamesLimit=5,t.default=new l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OWUtilsLite=class{static getSystemInformation(){return new Promise(e=>{overwolf.utils.getSystemInformation(t=>"success"!=t.status?e({}):e(t.systemInfo))})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="1.40.10"}]);
//# sourceMappingURL=owads.min.js.map